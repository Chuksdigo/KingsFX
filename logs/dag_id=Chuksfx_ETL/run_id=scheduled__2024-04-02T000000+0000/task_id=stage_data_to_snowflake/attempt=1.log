[2024-04-03T19:44:05.095+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T19:44:05.102+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T19:44:05.103+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 0
[2024-04-03T19:44:05.114+0000] {taskinstance.py:2217} INFO - Executing <Task(SnowflakeOperator): stage_data_to_snowflake> on 2024-04-02 00:00:00+00:00
[2024-04-03T19:44:05.119+0000] {standard_task_runner.py:60} INFO - Started process 6082 to run task
[2024-04-03T19:44:05.121+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Chuksfx_ETL', 'stage_data_to_snowflake', 'scheduled__2024-04-02T00:00:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/include/fx_dag.py', '--cfg-path', '/tmp/tmpomtr9o_l']
[2024-04-03T19:44:05.122+0000] {standard_task_runner.py:88} INFO - Job 39: Subtask stage_data_to_snowflake
[2024-04-03T19:44:05.166+0000] {task_command.py:423} INFO - Running <TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [running]> on host 506fa6827c3e
[2024-04-03T19:44:05.224+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Chuks' AIRFLOW_CTX_DAG_ID='Chuksfx_ETL' AIRFLOW_CTX_TASK_ID='stage_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-02T00:00:00+00:00'
[2024-04-03T19:44:05.226+0000] {sql.py:276} INFO - Executing: 
        PUT file://./opt/***/raw/df.csv@~
        
[2024-04-03T19:44:05.239+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 277, in execute
    hook = self.get_db_hook()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 188, in get_db_hook
    return self._hook
  File "/usr/local/lib/python3.8/functools.py", line 967, in __get__
    val = self.func(instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 150, in _hook
    conn = BaseHook.get_connection(conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/hooks/base.py", line 82, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 514, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `snowflake_conn` isn't defined
[2024-04-03T19:44:05.245+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=Chuksfx_ETL, task_id=stage_data_to_snowflake, execution_date=20240402T000000, start_date=20240403T194405, end_date=20240403T194405
[2024-04-03T19:44:05.256+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 39 for task stage_data_to_snowflake (The conn_id `snowflake_conn` isn't defined; 6082)
[2024-04-03T19:44:05.294+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-03T19:44:05.303+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/models/baseoperator.py:1201: AirflowProviderDeprecationWarning: Call to deprecated class SnowflakeOperator. (This class is deprecated. Please use `***.providers.common.sql.operators.sql.SQLExecuteQueryOperator`. Also, you can provide `hook_params={'warehouse': <warehouse>, 'database': <database>, 'role': <role>, 'schema': <schema>, 'authenticator': <authenticator>,'session_parameters': <session_parameters>}`.)
  result = cls.__new__(cls)

[2024-04-03T19:44:05.314+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-04-03T19:46:41.616+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T19:46:41.623+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T19:46:41.624+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 0
[2024-04-03T19:46:41.635+0000] {taskinstance.py:2217} INFO - Executing <Task(SnowflakeOperator): stage_data_to_snowflake> on 2024-04-02 00:00:00+00:00
[2024-04-03T19:46:41.640+0000] {standard_task_runner.py:60} INFO - Started process 6131 to run task
[2024-04-03T19:46:41.642+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Chuksfx_ETL', 'stage_data_to_snowflake', 'scheduled__2024-04-02T00:00:00+00:00', '--job-id', '42', '--raw', '--subdir', 'DAGS_FOLDER/include/fx_dag.py', '--cfg-path', '/tmp/tmp6czugxmm']
[2024-04-03T19:46:41.644+0000] {standard_task_runner.py:88} INFO - Job 42: Subtask stage_data_to_snowflake
[2024-04-03T19:46:41.683+0000] {task_command.py:423} INFO - Running <TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [running]> on host 506fa6827c3e
[2024-04-03T19:46:41.737+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Chuks' AIRFLOW_CTX_DAG_ID='Chuksfx_ETL' AIRFLOW_CTX_TASK_ID='stage_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-02T00:00:00+00:00'
[2024-04-03T19:46:41.738+0000] {sql.py:276} INFO - Executing: 
        PUT file://./opt/***/raw/df.csv@~
        
[2024-04-03T19:46:41.749+0000] {base.py:83} INFO - Using connection ID 'Snowflake_conn' for task execution.
[2024-04-03T19:46:41.756+0000] {base.py:83} INFO - Using connection ID 'Snowflake_conn' for task execution.
[2024-04-03T19:46:41.757+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-04-03T19:46:41.757+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-04-03T19:46:41.761+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5a7520>: Failed to establish a new connection: [Errno -2] Name or service not known')': /session/v1/login-request?request_id=1bb706bc-f941-4d2f-ac36-04a21ac6e408&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=acd9d149-1b89-4df4-8749-6cc68391d94c
[2024-04-03T19:46:42.774+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea550490>: Failed to establish a new connection: [Errno -2] Name or service not known')': /session/v1/login-request?request_id=4e2fb4e3-762b-4e6a-aa5a-458d4d84761d&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=96c73132-89c0-421d-b231-956aab3497ba
[2024-04-03T19:46:42.776+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/connection.py", line 79, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
snowflake.connector.vendored.urllib3.exceptions.NewConnectionError: <snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5a7670>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
snowflake.connector.vendored.urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='proimcy.europe%20west%204%20(netherlands).snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=1bb706bc-f941-4d2f-ac36-04a21ac6e408&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=acd9d149-1b89-4df4-8749-6cc68391d94c (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5a7670>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1078, in _request_exec
    raw_ret = session.request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
snowflake.connector.vendored.requests.exceptions.ConnectionError: HTTPSConnectionPool(host='proimcy.europe%20west%204%20(netherlands).snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=1bb706bc-f941-4d2f-ac36-04a21ac6e408&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=acd9d149-1b89-4df4-8749-6cc68391d94c (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5a7670>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1345, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 734, in _post_request
    ret = self.fetch(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 979, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 884, in _request_exec_wrapper
    return_object = self._request_exec(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1172, in _request_exec
    raise OperationalError(
snowflake.connector.errors.OperationalError: 251011: 251011: ConnectionTimeout occurred during login. Will be handled by authenticator

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 384, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 278, in get_conn
    conn = connector.connect(**conn_config)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 429, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 719, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1045, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1317, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1389, in _authenticate
    raise auth_op from e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1366, in _authenticate
    auth_instance.handle_timeout(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/by_plugin.py", line 212, in handle_timeout
    raise error
snowflake.connector.errors.OperationalError: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[2024-04-03T19:46:42.787+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=Chuksfx_ETL, task_id=stage_data_to_snowflake, execution_date=20240402T000000, start_date=20240403T194641, end_date=20240403T194642
[2024-04-03T19:46:42.801+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 42 for task stage_data_to_snowflake (250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting; 6131)
[2024-04-03T19:46:42.823+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-03T19:46:42.834+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/models/baseoperator.py:1201: AirflowProviderDeprecationWarning: Call to deprecated class SnowflakeOperator. (This class is deprecated. Please use `***.providers.common.sql.operators.sql.SQLExecuteQueryOperator`. Also, you can provide `hook_params={'warehouse': <warehouse>, 'database': <database>, 'role': <role>, 'schema': <schema>, 'authenticator': <authenticator>,'session_parameters': <session_parameters>}`.)
  result = cls.__new__(cls)

[2024-04-03T19:46:42.848+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-04-03T20:03:30.116+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T20:03:30.125+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T20:03:30.125+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 0
[2024-04-03T20:03:30.137+0000] {taskinstance.py:2217} INFO - Executing <Task(SnowflakeOperator): stage_data_to_snowflake> on 2024-04-02 00:00:00+00:00
[2024-04-03T20:03:30.142+0000] {standard_task_runner.py:60} INFO - Started process 6405 to run task
[2024-04-03T20:03:30.146+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Chuksfx_ETL', 'stage_data_to_snowflake', 'scheduled__2024-04-02T00:00:00+00:00', '--job-id', '47', '--raw', '--subdir', 'DAGS_FOLDER/include/fx_dag.py', '--cfg-path', '/tmp/tmpd8ebvd2f']
[2024-04-03T20:03:30.147+0000] {standard_task_runner.py:88} INFO - Job 47: Subtask stage_data_to_snowflake
[2024-04-03T20:03:30.190+0000] {task_command.py:423} INFO - Running <TaskInstance: Chuksfx_ETL.stage_data_to_snowflake scheduled__2024-04-02T00:00:00+00:00 [running]> on host 506fa6827c3e
[2024-04-03T20:03:30.284+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Chuks' AIRFLOW_CTX_DAG_ID='Chuksfx_ETL' AIRFLOW_CTX_TASK_ID='stage_data_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-02T00:00:00+00:00'
[2024-04-03T20:03:30.290+0000] {sql.py:276} INFO - Executing: 
        PUT file://./opt/***/raw/df.csv@~
        
[2024-04-03T20:03:30.323+0000] {base.py:83} INFO - Using connection ID 'Snowflake_conn' for task execution.
[2024-04-03T20:03:30.348+0000] {base.py:83} INFO - Using connection ID 'Snowflake_conn' for task execution.
[2024-04-03T20:03:30.352+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-04-03T20:03:30.359+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-04-03T20:03:30.370+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5b62b0>: Failed to establish a new connection: [Errno -2] Name or service not known')': /session/v1/login-request?request_id=2c27ca38-93fd-480c-ab80-6bce6a861843&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2911e14f-04b2-4b93-9797-ba3b54c3d7cb
[2024-04-03T20:03:31.385+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea165220>: Failed to establish a new connection: [Errno -2] Name or service not known')': /session/v1/login-request?request_id=b47018ff-c9e3-4571-b601-e34098f9464b&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3616665b-6757-4e4a-b533-1c76ddda334e
[2024-04-03T20:03:31.390+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/connection.py", line 79, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
snowflake.connector.vendored.urllib3.exceptions.NewConnectionError: <snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5b6400>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
snowflake.connector.vendored.urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='proimcy.europe%20west%204%20(netherlands).snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=2c27ca38-93fd-480c-ab80-6bce6a861843&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2911e14f-04b2-4b93-9797-ba3b54c3d7cb (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5b6400>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1078, in _request_exec
    raw_ret = session.request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
snowflake.connector.vendored.requests.exceptions.ConnectionError: HTTPSConnectionPool(host='proimcy.europe%20west%204%20(netherlands).snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=2c27ca38-93fd-480c-ab80-6bce6a861843&databaseName=ChuksFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2911e14f-04b2-4b93-9797-ba3b54c3d7cb (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5b6400>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1345, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 734, in _post_request
    ret = self.fetch(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 979, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 884, in _request_exec_wrapper
    return_object = self._request_exec(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1172, in _request_exec
    raise OperationalError(
snowflake.connector.errors.OperationalError: 251011: 251011: ConnectionTimeout occurred during login. Will be handled by authenticator

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 384, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 278, in get_conn
    conn = connector.connect(**conn_config)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 429, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 719, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1045, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1317, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1389, in _authenticate
    raise auth_op from e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1366, in _authenticate
    auth_instance.handle_timeout(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/by_plugin.py", line 212, in handle_timeout
    raise error
snowflake.connector.errors.OperationalError: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[2024-04-03T20:03:31.399+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=Chuksfx_ETL, task_id=stage_data_to_snowflake, execution_date=20240402T000000, start_date=20240403T200330, end_date=20240403T200331
[2024-04-03T20:03:31.410+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 47 for task stage_data_to_snowflake (250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting; 6405)
[2024-04-03T20:03:31.528+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-03T20:03:31.684+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/models/baseoperator.py:1201: AirflowProviderDeprecationWarning: Call to deprecated class SnowflakeOperator. (This class is deprecated. Please use `***.providers.common.sql.operators.sql.SQLExecuteQueryOperator`. Also, you can provide `hook_params={'warehouse': <warehouse>, 'database': <database>, 'role': <role>, 'schema': <schema>, 'authenticator': <authenticator>,'session_parameters': <session_parameters>}`.)
  result = cls.__new__(cls)

[2024-04-03T20:03:31.720+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-04-03T20:37:22.262+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_Snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T20:37:22.275+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_Snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T20:37:22.276+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 0
[2024-04-03T20:37:22.288+0000] {taskinstance.py:2217} INFO - Executing <Task(SnowflakeOperator): stage_data_to_Snowflake> on 2024-04-02 00:00:00+00:00
[2024-04-03T20:37:22.296+0000] {standard_task_runner.py:60} INFO - Started process 6934 to run task
[2024-04-03T20:37:22.299+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Chuksfx_ETL', 'stage_data_to_Snowflake', 'scheduled__2024-04-02T00:00:00+00:00', '--job-id', '51', '--raw', '--subdir', 'DAGS_FOLDER/include/fx_dag.py', '--cfg-path', '/tmp/tmpkttbq_8f']
[2024-04-03T20:37:22.300+0000] {standard_task_runner.py:88} INFO - Job 51: Subtask stage_data_to_Snowflake
[2024-04-03T20:37:22.344+0000] {task_command.py:423} INFO - Running <TaskInstance: Chuksfx_ETL.stage_data_to_Snowflake scheduled__2024-04-02T00:00:00+00:00 [running]> on host 506fa6827c3e
[2024-04-03T20:37:22.411+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Chuks' AIRFLOW_CTX_DAG_ID='Chuksfx_ETL' AIRFLOW_CTX_TASK_ID='stage_data_to_Snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-02T00:00:00+00:00'
[2024-04-03T20:37:22.413+0000] {sql.py:276} INFO - Executing: 
        PUT file://./opt/***/raw/df.csv@~
        
[2024-04-03T20:37:22.424+0000] {base.py:83} INFO - Using connection ID 'snowflake_conn' for task execution.
[2024-04-03T20:37:22.435+0000] {base.py:83} INFO - Using connection ID 'snowflake_conn' for task execution.
[2024-04-03T20:37:22.436+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-04-03T20:37:22.438+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-04-03T20:37:22.443+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea591880>: Failed to establish a new connection: [Errno -2] Name or service not known')': /session/v1/login-request?request_id=b3c98922-b09b-46a6-aa67-647b50f0c8e2&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=0a3e546e-1cf1-4c1e-84f9-1afc248474dc
[2024-04-03T20:37:23.458+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5428b0>: Failed to establish a new connection: [Errno -2] Name or service not known')': /session/v1/login-request?request_id=6c05b78a-1cc6-481f-a409-d6a6e4dba4d7&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=9057c619-2569-4d64-b03a-563983a183e9
[2024-04-03T20:37:23.464+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/connection.py", line 79, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
snowflake.connector.vendored.urllib3.exceptions.NewConnectionError: <snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea599970>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
snowflake.connector.vendored.urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='proimcy.europe%20west%204%20(netherlands).snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=b3c98922-b09b-46a6-aa67-647b50f0c8e2&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=0a3e546e-1cf1-4c1e-84f9-1afc248474dc (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea599970>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1078, in _request_exec
    raw_ret = session.request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
snowflake.connector.vendored.requests.exceptions.ConnectionError: HTTPSConnectionPool(host='proimcy.europe%20west%204%20(netherlands).snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=b3c98922-b09b-46a6-aa67-647b50f0c8e2&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=0a3e546e-1cf1-4c1e-84f9-1afc248474dc (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea599970>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1345, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 734, in _post_request
    ret = self.fetch(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 979, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 884, in _request_exec_wrapper
    return_object = self._request_exec(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1172, in _request_exec
    raise OperationalError(
snowflake.connector.errors.OperationalError: 251011: 251011: ConnectionTimeout occurred during login. Will be handled by authenticator

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 384, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 278, in get_conn
    conn = connector.connect(**conn_config)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 429, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 719, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1045, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1317, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1389, in _authenticate
    raise auth_op from e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1366, in _authenticate
    auth_instance.handle_timeout(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/by_plugin.py", line 212, in handle_timeout
    raise error
snowflake.connector.errors.OperationalError: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[2024-04-03T20:37:23.486+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=Chuksfx_ETL, task_id=stage_data_to_Snowflake, execution_date=20240402T000000, start_date=20240403T203722, end_date=20240403T203723
[2024-04-03T20:37:23.501+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 51 for task stage_data_to_Snowflake (250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting; 6934)
[2024-04-03T20:37:23.518+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-03T20:37:23.530+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/models/baseoperator.py:1201: AirflowProviderDeprecationWarning: Call to deprecated class SnowflakeOperator. (This class is deprecated. Please use `***.providers.common.sql.operators.sql.SQLExecuteQueryOperator`. Also, you can provide `hook_params={'warehouse': <warehouse>, 'database': <database>, 'role': <role>, 'schema': <schema>, 'authenticator': <authenticator>,'session_parameters': <session_parameters>}`.)
  result = cls.__new__(cls)

[2024-04-03T20:37:23.541+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-04-03T21:22:49.801+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_Snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T21:22:49.807+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Chuksfx_ETL.stage_data_to_Snowflake scheduled__2024-04-02T00:00:00+00:00 [queued]>
[2024-04-03T21:22:49.808+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 0
[2024-04-03T21:22:49.817+0000] {taskinstance.py:2217} INFO - Executing <Task(SnowflakeOperator): stage_data_to_Snowflake> on 2024-04-02 00:00:00+00:00
[2024-04-03T21:22:49.821+0000] {standard_task_runner.py:60} INFO - Started process 7634 to run task
[2024-04-03T21:22:49.824+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Chuksfx_ETL', 'stage_data_to_Snowflake', 'scheduled__2024-04-02T00:00:00+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/include/fx_dag.py', '--cfg-path', '/tmp/tmpbuvgubha']
[2024-04-03T21:22:49.825+0000] {standard_task_runner.py:88} INFO - Job 54: Subtask stage_data_to_Snowflake
[2024-04-03T21:22:49.862+0000] {task_command.py:423} INFO - Running <TaskInstance: Chuksfx_ETL.stage_data_to_Snowflake scheduled__2024-04-02T00:00:00+00:00 [running]> on host 506fa6827c3e
[2024-04-03T21:22:49.927+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Chuks' AIRFLOW_CTX_DAG_ID='Chuksfx_ETL' AIRFLOW_CTX_TASK_ID='stage_data_to_Snowflake' AIRFLOW_CTX_EXECUTION_DATE='2024-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-02T00:00:00+00:00'
[2024-04-03T21:22:49.929+0000] {sql.py:276} INFO - Executing: 
        PUT file://./opt/***/raw/df.csv@~
        
[2024-04-03T21:22:49.939+0000] {base.py:83} INFO - Using connection ID 'snowflake_conn' for task execution.
[2024-04-03T21:22:49.948+0000] {base.py:83} INFO - Using connection ID 'snowflake_conn' for task execution.
[2024-04-03T21:22:49.949+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.19, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-04-03T21:22:49.951+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-04-03T21:22:53.674+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5918e0>: Failed to establish a new connection: [Errno -2] Name or service not known')': //proimcy-se28251.Europe%20West%204%20(Netherlands).snowflakecomputing.com:443/session/v1/login-request?request_id=99d68079-dd11-4223-adb2-cf57e5f41211&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN
[2024-04-03T21:23:02.150+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea541910>: Failed to establish a new connection: [Errno -2] Name or service not known')': //proimcy-se28251.Europe%20West%204%20(Netherlands).snowflakecomputing.com:443/session/v1/login-request?request_id=bbbb9b8d-db80-44fe-bd7e-b509091fe1b6&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN
[2024-04-03T21:23:05.867+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/connection.py", line 79, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
snowflake.connector.vendored.urllib3.exceptions.NewConnectionError: <snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5999d0>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
snowflake.connector.vendored.urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='https', port=443): Max retries exceeded with url: //proimcy-se28251.Europe%20West%204%20(Netherlands).snowflakecomputing.com:443/session/v1/login-request?request_id=99d68079-dd11-4223-adb2-cf57e5f41211&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5999d0>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1078, in _request_exec
    raw_ret = session.request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
snowflake.connector.vendored.requests.exceptions.ConnectionError: HTTPSConnectionPool(host='https', port=443): Max retries exceeded with url: //proimcy-se28251.Europe%20West%204%20(Netherlands).snowflakecomputing.com:443/session/v1/login-request?request_id=99d68079-dd11-4223-adb2-cf57e5f41211&databaseName=CHUKSFX&schemaName=ODS&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x7f34ea5999d0>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1345, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 734, in _post_request
    ret = self.fetch(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 979, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 884, in _request_exec_wrapper
    return_object = self._request_exec(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/network.py", line 1172, in _request_exec
    raise OperationalError(
snowflake.connector.errors.OperationalError: 251011: 251011: ConnectionTimeout occurred during login. Will be handled by authenticator

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 384, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 278, in get_conn
    conn = connector.connect(**conn_config)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 429, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 719, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1045, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1317, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1389, in _authenticate
    raise auth_op from e
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1366, in _authenticate
    auth_instance.handle_timeout(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/by_plugin.py", line 212, in handle_timeout
    raise error
snowflake.connector.errors.OperationalError: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[2024-04-03T21:23:05.880+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=Chuksfx_ETL, task_id=stage_data_to_Snowflake, execution_date=20240402T000000, start_date=20240403T212249, end_date=20240403T212305
[2024-04-03T21:23:05.890+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 54 for task stage_data_to_Snowflake (250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting; 7634)
[2024-04-03T21:23:05.939+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-03T21:23:05.950+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/***/models/baseoperator.py:1201: AirflowProviderDeprecationWarning: Call to deprecated class SnowflakeOperator. (This class is deprecated. Please use `***.providers.common.sql.operators.sql.SQLExecuteQueryOperator`. Also, you can provide `hook_params={'warehouse': <warehouse>, 'database': <database>, 'role': <role>, 'schema': <schema>, 'authenticator': <authenticator>,'session_parameters': <session_parameters>}`.)
  result = cls.__new__(cls)

[2024-04-03T21:23:05.962+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
